!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=2)}([function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,l){function a(e){try{c(r.next(e))}catch(e){l(e)}}function i(e){try{c(r.throw(e))}catch(e){l(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(3),l=n(1),a=n(4);var i;function c(e){o.issue("error",e)}function u(e){o.issue("group",e)}function s(){o.issue("endgroup")}!function(e){e[e.Success=0]="Success",e[e.Failure=1]="Failure"}(i=t.ExitCode||(t.ExitCode={})),t.exportVariable=function(e,t){process.env[e]=t,o.issueCommand("set-env",{name:e},t)},t.setSecret=function(e){o.issueCommand("add-mask",{},e)},t.addPath=function(e){o.issueCommand("add-path",{},e),process.env.PATH=`${e}${a.delimiter}${process.env.PATH}`},t.getInput=function(e,t){const n=process.env[`INPUT_${e.replace(/ /g,"_").toUpperCase()}`]||"";if(t&&t.required&&!n)throw new Error(`Input required and not supplied: ${e}`);return n.trim()},t.setOutput=function(e,t){o.issueCommand("set-output",{name:e},t)},t.setFailed=function(e){process.exitCode=i.Failure,c(e)},t.debug=function(e){o.issueCommand("debug",{},e)},t.error=c,t.warning=function(e){o.issue("warning",e)},t.info=function(e){process.stdout.write(e+l.EOL)},t.startGroup=u,t.endGroup=s,t.group=function(e,t){return r(this,void 0,void 0,(function*(){let n;u(e);try{n=yield t()}finally{s()}return n}))},t.saveState=function(e,t){o.issueCommand("save-state",{name:e},t)},t.getState=function(e){return process.env[`STATE_${e}`]||""}},function(e,t){e.exports=require("os")},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,l){function a(e){try{c(r.next(e))}catch(e){l(e)}}function i(e){try{c(r.throw(e))}catch(e){l(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,l,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return l={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function i(l){return function(i){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&l[0]?r.return:l[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,l[1])).done)return o;switch(r=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return a.label++,{value:l[1],done:!1};case 5:a.label++,r=l[1],l=[0];continue;case 7:l=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===l[0]||2===l[0])){a=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){a.label=l[1];break}if(6===l[0]&&a.label<o[1]){a.label=o[1],o=l;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(l);break}o[2]&&a.ops.pop(),a.trys.pop();continue}l=t.call(e,a)}catch(e){l=[6,e],r=0}finally{n=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,i])}}};Object.defineProperty(t,"__esModule",{value:!0});var l=n(0),a=n(5),i=n(6),c=n(7),u=n(8),s=c.promisify(i.readFile),f=c.promisify(i.writeFile);!function(){r(this,void 0,void 0,(function(){var e,t,n,r,i,c;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),e=a.getInputs(),t=e.version,n=e.manifest,[4,s(n,{encoding:"utf-8"})];case 1:return r=o.sent(),i=u.default(r,t),[4,f(n,i,{encoding:"utf-8"})];case 2:return o.sent(),[3,4];case 3:return c=o.sent(),l.setFailed(c.message),[3,4];case 4:return[2]}}))}))}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(1);function o(e,t,n){const o=new a(e,t,n);process.stdout.write(o.toString()+r.EOL)}t.issueCommand=o,t.issue=function(e,t=""){o(e,{},t)};const l="::";class a{constructor(e,t,n){e||(e="missing.command"),this.command=e,this.properties=t,this.message=n}toString(){let e=l+this.command;if(this.properties&&Object.keys(this.properties).length>0){e+=" ";for(const n in this.properties)if(this.properties.hasOwnProperty(n)){const r=this.properties[n];r&&(e+=`${n}=${t=`${r||""}`,t.replace(/\r/g,"%0D").replace(/\n/g,"%0A").replace(/]/g,"%5D").replace(/;/g,"%3B")},`)}}var t;return e+=l,e+=function(e){return e.replace(/\r/g,"%0D").replace(/\n/g,"%0A")}(`${this.message||""}`),e}}},function(e,t){e.exports=require("path")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.getInputs=function(){return{version:r.getInput("version",{required:!0}),manifest:r.getInput("manifest")||"Cargo.toml"}}},function(e,t){e.exports=require("fs")},function(e,t){e.exports=require("util")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9);t.default=function(e,t){var n=r.parse(e);return n.package.version=t,r.patch(e,n)}},function(e,t,n){"use strict";
//! toml-patch v0.2.3 - https://github.com/timhall/toml-patch - @license: MIT
var r,o;function l(e){return e.type===r.Document}function a(e){return e.type===r.Table}function i(e){return e.type===r.TableArray}function c(e){return e.type===r.KeyValue}function u(e){return e.type===r.InlineArray}function s(e){return e.type===r.InlineItem}function f(e){return e.type===r.InlineTable}function d(e){return e.type===r.Comment}function m(e){return l(e)||a(e)||i(e)||f(e)||u(e)}function p(e){return function(e){return e.type===r.TableKey}(e)||function(e){return e.type===r.TableArrayKey}(e)||s(e)}n.r(t),n.d(t,"parse",(function(){return ct})),n.d(t,"patch",(function(){return it})),n.d(t,"stringify",(function(){return ut})),function(e){e.Document="Document",e.Table="Table",e.TableKey="TableKey",e.TableArray="TableArray",e.TableArrayKey="TableArrayKey",e.KeyValue="KeyValue",e.Key="Key",e.String="String",e.Integer="Integer",e.Float="Float",e.Boolean="Boolean",e.DateTime="DateTime",e.InlineArray="InlineArray",e.InlineItem="InlineItem",e.InlineTable="InlineTable",e.Comment="Comment"}(r||(r={}));class y{constructor(e){this.iterator=e,this.index=-1,this.value=void 0,this.done=!1,this.peeked=null}next(){if(this.done)return v();const e=this.peeked||this.iterator.next();return this.index+=1,this.value=e.value,this.done=e.done,this.peeked=null,e}peek(){return this.done?v():this.peeked?this.peeked:(this.peeked=this.iterator.next(),this.peeked)}[Symbol.iterator](){return this}}function v(){return{value:void 0,done:!0}}function h(e){return{lines:e.end.line-e.start.line+1,columns:e.end.column-e.start.column}}function w(e,t){const n=Array.isArray(e)?e:g(e),r=n.findIndex(e=>e>=t)+1;return{line:r,column:t-(n[r-2]+1||0)}}function g(e){const t=/[\r\n|\n]/g,n=[];let r;for(;null!=(r=t.exec(e));)n.push(r.index);return n.push(e.length+1),n}function b(e){return{line:e.line,column:e.column}}function k(e){return{start:b(e.start),end:b(e.end)}}class x extends Error{constructor(e,t,n){let r=`Error parsing TOML (${t.line}, ${t.column+1}):\n`;if(e){const n=function(e,t){const n=g(e),r=n[t.line-2]||0,o=n[t.line-1]||e.length;return e.substr(r,o-r)}(e,t),o=`${function(e,t=" "){return t.repeat(e)}(t.column)}^`;n&&(r+=`${n}\n${o}\n`)}r+=n,super(r),this.line=t.line,this.column=t.column}}!function(e){e.Bracket="Bracket",e.Curly="Curly",e.Equal="Equal",e.Comma="Comma",e.Dot="Dot",e.Comment="Comment",e.Literal="Literal"}(o||(o={}));const T=/\s/,I=/(\r\n|\n)/,A='"',E="'",$=" ",S="\\",O=/[\w,\d,\",\',\+,\-,\_]/;function*C(e){const t=new y(e[Symbol.iterator]());t.next();const n=function(e){const t=g(e);return(e,n)=>({start:w(t,e),end:w(t,n)})}(e);for(;!t.done;){if(T.test(t.value));else if("["===t.value||"]"===t.value)yield K(t,n,o.Bracket);else if("{"===t.value||"}"===t.value)yield K(t,n,o.Curly);else if("="===t.value)yield K(t,n,o.Equal);else if(","===t.value)yield K(t,n,o.Comma);else if("."===t.value)yield K(t,n,o.Dot);else if("#"===t.value)yield _(t,n);else{const r=B(e,t.index,E)||B(e,t.index,A);r?yield j(t,n,r,e):yield D(t,n,e)}t.next()}}function K(e,t,n){return{type:n,raw:e.value,loc:t(e.index,e.index+1)}}function _(e,t){const n=e.index;let r=e.value;for(;!e.peek().done&&!I.test(e.peek().value);)e.next(),r+=e.value;return{type:o.Comment,raw:r,loc:t(n,e.index+1)}}function j(e,t,n,r){const l=e.index;let a=n+n+n,i=a;for(e.next(),e.next(),e.next();!e.done&&!B(r,e.index,n);)i+=e.value,e.next();if(e.done)throw new x(r,w(r,e.index),`Expected close of multiline string with ${a}, reached end of file`);return i+=a,e.next(),e.next(),{type:o.Literal,raw:i,loc:t(l,e.index+1)}}function D(e,t,n){if(!O.test(e.value))throw new x(n,w(n,e.index),`Unsupported character "${e.value}". Expected ALPHANUMERIC, ", ', +, -, or _`);const r=e.index;let l=e.value,a=e.value===A,i=e.value===E;const c=e=>{if(e.peek().done)return!0;const t=e.peek().value;return!(a||i)&&(T.test(t)||","===t||"."===t||"]"===t||"}"===t||"="===t)};for(;!e.done&&!c(e)&&(e.next(),e.value===A&&(a=!a),e.value!==E||a||(i=!i),l+=e.value,!e.peek().done);){let t=e.peek().value;a&&e.value===S&&(t===A?(l+=A,e.next()):t===S&&(l+=S,e.next()))}if(a||i)throw new x(n,w(n,r),`Expected close of string with ${a?A:E}`);return{type:o.Literal,raw:l,loc:t(r,e.index+1)}}function B(e,t,n){return e[t]===n&&e[t+1]===n&&e[t+2]===n&&n}function F(e){return e[e.length-1]}function M(){return Object.create(null)}function P(e){return"number"==typeof e&&e%1==0}function q(e){return"[object Date]"===Object.prototype.toString.call(e)}function N(e){return e&&"object"==typeof e&&!q(e)&&!Array.isArray(e)}function L(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function U(e,...t){return t.reduce((e,t)=>t(e),e)}function V(e){if(N(e)){return`{${Object.keys(e).sort().map(t=>`${JSON.stringify(t)}:${V(e[t])}`).join(",")}}`}return Array.isArray(e)?`[${e.map(V).join(",")}]`:JSON.stringify(e)}function R(e,t){const n=e.length,r=t.length;e.length=n+r;for(let o=0;o<r;o++)e[n+o]=t[o]}const W='"""',J="'''",z="\\n",G="\\r\\n",H=/\r\n/g,Q=/\n/g,X=/^(\r\n|\n)/,Y=/\\\s*[\n\r\n]\s*/g;function Z(e){return e.startsWith(J)?U(te(e,3),ne):e.startsWith(E)?te(e,1):e.startsWith(W)?U(te(e,3),ne,oe,re,ee):e.startsWith(A)?U(te(e,1),ee):e}function ee(e){const t=e.replace(/\\U[a-fA-F0-9]{8}/g,e=>{const t=parseInt(e.replace("\\U",""),16),n=String.fromCodePoint(t);return te(JSON.stringify(n),1)});return JSON.parse(`"${t}"`)}function te(e,t){return e.substr(t,e.length-2*t)}function ne(e){return X.test(e)?e.substr(1):e}function re(e){return e.replace(H,G).replace(Q,z)}function oe(e){return e.replace(Y,"")}const le="true",ae="false",ie=/e/i,ce=/\_/g,ue=/inf/,se=/nan/,fe=/^0x/,de=/^0o/,me=/^0b/,pe=/(\d{4})-(\d{2})-(\d{2})/,ye=/(\d{2}):(\d{2}):(\d{2})/;function*ve(e){const t=C(e),n=new y(t);for(;!n.next().done;)yield*he(n,e)}function*he(e,t){if(e.value.type===o.Comment)yield ge(e);else if(e.value.type===o.Bracket)yield function(e,t){const n=e.peek().done||e.peek().value.type!==o.Bracket?r.Table:r.TableArray,l=n===r.Table;if(l&&"["!==e.value.raw)throw new x(t,e.value.loc.start,`Expected table opening "[", found ${e.value.raw}`);if(!l&&("["!==e.value.raw||"["!==e.peek().value.raw))throw new x(t,e.value.loc.start,`Expected array of tables opening "[[", found ${e.value.raw+e.peek().value.raw}`);const a=l?{type:r.TableKey,loc:e.value.loc}:{type:r.TableArrayKey,loc:e.value.loc};e.next(),n===r.TableArray&&e.next();if(e.done)throw new x(t,a.loc.start,"Expected table key, reached end of file");a.item={type:r.Key,loc:k(e.value.loc),raw:e.value.raw,value:[Z(e.value.raw)]};for(;!e.peek().done&&e.peek().value.type===o.Dot;){e.next();const t=e.value;e.next();const n=" ".repeat(t.loc.start.column-a.item.loc.end.column),r=" ".repeat(e.value.loc.start.column-t.loc.end.column);a.item.loc.end=e.value.loc.end,a.item.raw+=`${n}.${r}${e.value.raw}`,a.item.value.push(Z(e.value.raw))}if(e.next(),l&&(e.done||"]"!==e.value.raw))throw new x(t,e.done?a.item.loc.end:e.value.loc.start,`Expected table closing "]", found ${e.done?"end of file":e.value.raw}`);if(!l&&(e.done||e.peek().done||"]"!==e.value.raw||"]"!==e.peek().value.raw))throw new x(t,e.done||e.peek().done?a.item.loc.end:e.value.loc.start,`Expected array of tables closing "]]", found ${e.done||e.peek().done?"end of file":e.value.raw+e.peek().value.raw}`);l||e.next();a.loc.end=e.value.loc.end;let i=[];for(;!e.peek().done&&e.peek().value.type!==o.Bracket;)e.next(),R(i,[...he(e,t)]);return{type:l?r.Table:r.TableArray,loc:{start:b(a.loc.start),end:b(i.length?i[i.length-1].loc.end:a.loc.end)},key:a,items:i}}(e,t);else{if(e.value.type!==o.Literal)throw new x(t,e.value.loc.start,`Unexpected token "${e.value.type}". Expected Comment, Bracket, or String`);yield*function(e,t){const n={type:r.Key,loc:k(e.value.loc),raw:e.value.raw,value:[Z(e.value.raw)]};for(;!e.peek().done&&e.peek().value.type===o.Dot;)e.next(),e.next(),n.loc.end=e.value.loc.end,n.raw+=`.${e.value.raw}`,n.value.push(Z(e.value.raw));if(e.next(),e.done||e.value.type!==o.Equal)throw new x(t,e.done?n.loc.end:e.value.loc.start,`Expected "=" for key-value, found ${e.done?"end of file":e.value.raw}`);const l=e.value.loc.start.column;if(e.next(),e.done)throw new x(t,n.loc.start,"Expected value for key-value, reached end of file");const[a,...i]=we(e,t);return[{type:r.KeyValue,key:n,value:a,loc:{start:b(n.loc.start),end:b(a.loc.end)},equals:l},...i]}(e,t)}}function*we(e,t){if(e.value.type===o.Literal)e.value.raw[0]===A||e.value.raw[0]===E?yield function(e){return{type:r.String,loc:e.value.loc,raw:e.value.raw,value:Z(e.value.raw)}}(e):e.value.raw===le||e.value.raw===ae?yield function(e){return{type:r.Boolean,loc:e.value.loc,value:e.value.raw===le}}(e):pe.test(e.value.raw)||ye.test(e.value.raw)?yield function(e,t){let n,l=e.value.loc,a=e.value.raw;if(!e.peek().done&&e.peek().value.type===o.Literal&&pe.test(a)&&ye.test(e.peek().value.raw)){const t=l.start;e.next(),l={start:t,end:e.value.loc.end},a+=` ${e.value.raw}`}if(!e.peek().done&&e.peek().value.type===o.Dot){const n=l.start;if(e.next(),e.peek().done||e.peek().value.type!==o.Literal)throw new x(t,e.value.loc.end,"Expected fractional value for DateTime");e.next(),l={start:n,end:e.value.loc.end},a+=`.${e.value.raw}`}if(pe.test(a))n=new Date(a.replace(" ","T"));else{const[e]=(new Date).toISOString().split("T");n=new Date(`${e}T${a}`)}return{type:r.DateTime,loc:l,raw:a,value:n}}(e,t):!e.peek().done&&e.peek().value.type===o.Dot||ue.test(e.value.raw)||se.test(e.value.raw)||ie.test(e.value.raw)&&!fe.test(e.value.raw)?yield function(e,t){let n,l=e.value.loc,a=e.value.raw;if(ue.test(a))n="-inf"===a?-1/0:1/0;else if(se.test(a))n=NaN;else if(e.peek().done||e.peek().value.type!==o.Dot)n=Number(a.replace(ce,""));else{const r=l.start;if(e.next(),e.peek().done||e.peek().value.type!==o.Literal)throw new x(t,e.value.loc.end,"Expected fraction value for Float");e.next(),a+=`.${e.value.raw}`,l={start:r,end:e.value.loc.end},n=Number(a.replace(ce,""))}return{type:r.Float,loc:l,raw:a,value:n}}(e,t):yield function(e){if("-0"===e.value.raw||"+0"===e.value.raw)return{type:r.Integer,loc:e.value.loc,raw:e.value.raw,value:0};let t=10;fe.test(e.value.raw)?t=16:de.test(e.value.raw)?t=8:me.test(e.value.raw)&&(t=2);const n=parseInt(e.value.raw.replace(ce,"").replace(de,"").replace(me,""),t);return{type:r.Integer,loc:e.value.loc,raw:e.value.raw,value:n}}(e);else if(e.value.type===o.Curly)yield function(e,t){if("{"!==e.value.raw)throw new x(t,e.value.loc.start,`Expected "{" for inline table, found ${e.value.raw}`);const n={type:r.InlineTable,loc:k(e.value.loc),items:[]};e.next();for(;!e.done&&(e.value.type!==o.Curly||"}"!==e.value.raw);){if(e.value.type===o.Comma){const r=n.items[n.items.length-1];if(!r)throw new x(t,e.value.loc.start,'Found "," without previous value in inline table');r.comma=!0,r.loc.end=e.value.loc.start,e.next();continue}const[l]=he(e,t);if(l.type!==r.KeyValue)throw new x(t,e.value.loc.start,`Only key-values are supported in inline tables, found ${l.type}`);const a={type:r.InlineItem,loc:k(l.loc),item:l,comma:!1};n.items.push(a),e.next()}if(e.done||e.value.type!==o.Curly||"}"!==e.value.raw)throw new x(t,e.done?n.loc.start:e.value.loc.start,`Expected "}", found ${e.done?"end of file":e.value.raw}`);return n.loc.end=e.value.loc.end,n}(e,t);else{if(e.value.type!==o.Bracket)throw new x(t,e.value.loc.start,`Unrecognized token type "${e.value.type}". Expected String, Curly, or Bracket`);{const[n,l]=function(e,t){if("["!==e.value.raw)throw new x(t,e.value.loc.start,`Expected "[" for inline array, found ${e.value.raw}`);const n={type:r.InlineArray,loc:k(e.value.loc),items:[]};let l=[];e.next();for(;!e.done&&(e.value.type!==o.Bracket||"]"!==e.value.raw);){if(e.value.type===o.Comma){const r=n.items[n.items.length-1];if(!r)throw new x(t,e.value.loc.start,'Found "," without previous value for inline array');r.comma=!0,r.loc.end=e.value.loc.start}else if(e.value.type===o.Comment)l.push(ge(e));else{const[o,...a]=we(e,t),i={type:r.InlineItem,loc:k(o.loc),item:o,comma:!1};n.items.push(i),R(l,a)}e.next()}if(e.done||e.value.type!==o.Bracket||"]"!==e.value.raw)throw new x(t,e.done?n.loc.start:e.value.loc.start,`Expected "]", found ${e.done?"end of file":e.value.raw}`);return n.loc.end=e.value.loc.end,[n,l]}(e,t);yield n,yield*l}}}function ge(e){return{type:r.Comment,loc:e.value.loc,raw:e.value.raw}}function be(e,t){var n;function o(e,t){for(const n of e)l(n,t)}function l(e,n){const a=t[e.type];switch(a&&"function"==typeof a&&a(e,n),a&&a.enter&&a.enter(e,n),e.type){case r.Document:o(e.items,e);break;case r.Table:l(e.key,e),o(e.items,e);break;case r.TableKey:l(e.item,e);break;case r.TableArray:l(e.key,e),o(e.items,e);break;case r.TableArrayKey:l(e.item,e);break;case r.KeyValue:l(e.key,e),l(e.value,e);break;case r.InlineArray:o(e.items,e);break;case r.InlineItem:l(e.item,e);break;case r.InlineTable:o(e.items,e);break;case r.Key:case r.String:case r.Integer:case r.Float:case r.Boolean:case r.DateTime:case r.Comment:break;default:throw new Error(`Unrecognized node type "${e.type}"`)}a&&a.exit&&a.exit(e,n)}null!=(n=e)&&"function"==typeof n[Symbol.iterator]?o(e,null):l(e,null)}const ke=new WeakMap,xe=e=>(ke.has(e)||ke.set(e,new WeakMap),ke.get(e)),Te=new WeakMap,Ie=e=>(Te.has(e)||Te.set(e,new WeakMap),Te.get(e));function Ae(e,t,n,r){if(m(t)){const e=t.items.indexOf(n);if(e<0)throw new Error("Could not find existing item in parent node for replace");t.items.splice(e,1,r)}else if(p(t))t.item=r;else{if(!c(t))throw new Error(`Unsupported parent type "${t.type}" for replace`);t.key===n?t.key=r:t.value=r}Ke(r,{lines:n.loc.start.line-r.loc.start.line,columns:n.loc.start.column-r.loc.start.column});const o=h(n.loc),l=h(r.loc);_e({lines:l.lines-o.lines,columns:l.columns-o.columns},Ie(e),r,n)}function Ee(e,t,n,r){if(!m(t))throw new Error(`Unsupported parent type "${t.type}" for insert`);let o,p;r=null!=r?r:t.items.length,u(t)||f(t)?({shift:o,offset:p}=function(e,t,n){if(!s(t))throw new Error(`Incompatible child type "${t.type}"`);const r=null!=n?e.items[n-1]:F(e.items),o=null==n||n===e.items.length;e.items.splice(n,0,t);const l=!!r,a=!o,i=o&&!0===t.comma;l&&(r.comma=!0);a&&(t.comma=!0);const c=u(e)&&function(e){if(!e.items.length)return!1;return h(e.loc).lines>e.items.length}(e),f=r?{line:r.loc.end.line,column:c?d(r)?e.loc.start.column:r.loc.start.column:r.loc.end.column}:b(e.loc.start);let m=0;if(c)m=1;else{const e=2,t=1;f.column+=l?e:t}f.line+=m;const p={lines:f.line-t.loc.start.line,columns:f.column-t.loc.start.column},y=h(t.loc),v={lines:y.lines+(m-1),columns:y.columns+(l||a?2:0)+(i?1:0)};return{shift:p,offset:v}}(t,n,r)):({shift:o,offset:p}=function(e,t,n){if(r=t,!(c(r)||a(r)||i(r)||d(r)))throw new Error(`Incompatible child type "${t.type}"`);var r;const o=e.items[n-1],u=l(e)&&!e.items.length;e.items.splice(n,0,t);const s=o?{line:o.loc.end.line,column:d(o)?e.loc.start.column:o.loc.start.column}:b(e.loc.start),f=a(t)||i(t);let m=0;u||(m=f?2:1);s.line+=m;const p={lines:s.line-t.loc.start.line,columns:s.column-t.loc.start.column},y=h(t.loc),v={lines:y.lines+(m-1),columns:y.columns};return{shift:p,offset:v}}(t,n,r)),Ke(n,o);const y=t.items[r-1],v=y&&Ie(e).get(y);v&&(p.lines+=v.lines,p.columns+=v.columns,s(n)&&y&&t.items[r+1]&&(p.columns-=2),Ie(e).delete(y)),Ie(e).set(n,p)}function $e(e,t,n){if(!m(t))throw new Error(`Unsupported parent type "${t.type}" for remove`);let r=t.items.indexOf(n);if(r<0){if(r=t.items.findIndex(e=>p(e)&&e.item===n),r<0)throw new Error("Could not find node in parent for removal");n=t.items[r]}const o=t.items[r-1];let l=t.items[r+1];t.items.splice(r,1);let a=h(n.loc);l&&d(l)&&l.loc.start.line===n.loc.end.line&&(a=h({start:n.loc.start,end:l.loc.end}),l=t.items[r+1],t.items.splice(r,1));const i=o&&s(o),c=o&&o.loc.end.line===n.loc.start.line,u=l&&l.loc.start.line===n.loc.end.line,f=i&&(c||u),y={lines:-(a.lines-(f?1:0)),columns:-a.columns};i&&c&&(y.columns-=2),i&&o&&!l&&(o.comma=!1);const v=o||t,w=o?Ie(e):xe(e),g=Ie(e),b=w.get(v);b&&(y.lines+=b.lines,y.columns+=b.columns);const k=g.get(n);k&&(y.lines+=k.lines,y.columns+=k.columns),w.set(v,y)}function Se(e,t,n=!0){if(!n)return;if(!t.items.length)return;_e({lines:0,columns:1},xe(e),t);const r=F(t.items);_e({lines:0,columns:1},Ie(e),r)}function Oe(e,t,n=!1){if(!n)return;if(!t.items.length)return;const r=F(t.items);r.comma=!0,_e({lines:0,columns:1},Ie(e),r)}function Ce(e){const t=xe(e),n=Ie(e),o={lines:0,columns:{}};function l(e){e.loc.start.line+=o.lines,e.loc.start.column+=o.columns[e.loc.start.line]||0;const n=t.get(e);n&&(o.lines+=n.lines,o.columns[e.loc.start.line]=(o.columns[e.loc.start.line]||0)+n.columns)}function a(e){e.loc.end.line+=o.lines,e.loc.end.column+=o.columns[e.loc.end.line]||0;const t=n.get(e);t&&(o.lines+=t.lines,o.columns[e.loc.end.line]=(o.columns[e.loc.end.line]||0)+t.columns)}const i={enter:l,exit:a};be(e,{[r.Document]:i,[r.Table]:i,[r.TableArray]:i,[r.InlineTable]:i,[r.InlineArray]:i,[r.InlineItem]:i,[r.TableKey]:i,[r.TableArrayKey]:i,[r.KeyValue]:{enter(e){const t=e.loc.start.line+o.lines,r=n.get(e.key);e.equals+=(o.columns[t]||0)+(r?r.columns:0),l(e)},exit:a},[r.Key]:i,[r.String]:i,[r.Integer]:i,[r.Float]:i,[r.Boolean]:i,[r.DateTime]:i,[r.Comment]:i}),ke.delete(e),Te.delete(e)}function Ke(e,t,n={}){const{first_line_only:o=!1}=n,l=e.loc.start.line,{lines:a,columns:i}=t,c=e=>{o&&e.loc.start.line!==l||(e.loc.start.column+=i,e.loc.end.column+=i),e.loc.start.line+=a,e.loc.end.line+=a};return be(e,{[r.Table]:c,[r.TableKey]:c,[r.TableArray]:c,[r.TableArrayKey]:c,[r.KeyValue](e){c(e),e.equals+=i},[r.Key]:c,[r.String]:c,[r.Integer]:c,[r.Float]:c,[r.Boolean]:c,[r.DateTime]:c,[r.InlineArray]:c,[r.InlineItem]:c,[r.InlineTable]:c,[r.Comment]:c}),e}function _e(e,t,n,r){const o=t.get(r||n);o&&(e.lines+=o.lines,e.columns+=o.columns),t.set(n,e)}function je(){return{type:r.Document,loc:{start:{line:1,column:0},end:{line:1,column:0}},items:[]}}function De(e){const t=function(e){const t=Pe(e);return{type:r.TableKey,loc:{start:{line:1,column:0},end:{line:1,column:t.length+2}},item:{type:r.Key,loc:{start:{line:1,column:1},end:{line:1,column:t.length+1}},value:e,raw:t}}}(e);return{type:r.Table,loc:k(t.loc),key:t,items:[]}}function Be(e){const t=function(e){const t=Pe(e);return{type:r.TableArrayKey,loc:{start:{line:1,column:0},end:{line:1,column:t.length+4}},item:{type:r.Key,loc:{start:{line:1,column:2},end:{line:1,column:t.length+2}},value:e,raw:t}}}(e);return{type:r.TableArray,loc:k(t.loc),key:t,items:[]}}function Fe(e,t){const n=function(e){const t=Pe(e);return{type:r.Key,loc:{start:{line:1,column:0},end:{line:1,column:t.length}},raw:t,value:e}}(e),{column:o}=n.loc.end,l=o+1;return Ke(t,{lines:0,columns:o+3-t.loc.start.column},{first_line_only:!0}),{type:r.KeyValue,loc:{start:b(n.loc.start),end:b(t.loc.end)},key:n,equals:l,value:t}}const Me=/[\w,\d,\_,\-]+/;function Pe(e){return e.map(e=>Me.test(e)?e:JSON.stringify(e)).join(".")}function qe(e){return{type:r.InlineItem,loc:k(e.loc),item:e,comma:!1}}function Ne(e){return e.items.filter(e=>{if(!c(e))return!1;const t=f(e.value),n=u(e.value)&&e.value.items.length&&f(e.value.items[0].item);return t||n}).forEach(t=>{$e(e,e,t),f(t.value)?Ee(e,e,function(e){const t=De(e.key.value);for(const n of e.value.items)Ee(t,t,n.item);return Ce(t),t}(t)):function(e){const t=je();for(const n of e.value.items){const r=Be(e.key.value);Ee(t,t,r);for(const e of n.item.items)Ee(t,r,e.item)}return Ce(t),t.items}(t).forEach(t=>{Ee(e,e,t)})}),Ce(e),e}function Le(e){let t=0,n=0;for(const r of e.items)0===n&&r.loc.start.line>1?t=1-r.loc.start.line:r.loc.start.line+t>n+2&&(t+=n+2-(r.loc.start.line+t)),Ke(r,{lines:t,columns:0}),n=r.loc.end.line;return e}const Ue={printWidth:80,trailingComma:!1,bracketSpacing:!0};function Ve(e,t={}){t=Object.assign({},Ue,t),e=Je(e);const n=je();for(const r of Re(e,t))Ee(n,n,r);return Ce(n),U(n,Ne,e=>(function(e,t){return e})(e),Le)}function*Re(e,t){for(const n of Object.keys(e))yield Fe([n],We(e[n],t))}function We(e,t){if(null==e)throw new Error('"null" and "undefined" values are not supported');return function(e){return"string"==typeof e}(e)?function(e){const t=JSON.stringify(e);return{type:r.String,loc:{start:{line:1,column:0},end:{line:1,column:t.length}},raw:t,value:e}}(e):P(e)?function(e){const t=e.toString();return{type:r.Integer,loc:{start:{line:1,column:0},end:{line:1,column:t.length}},raw:t,value:e}}(e):function(e){return"number"==typeof e&&!P(e)}(e)?function(e){const t=e.toString();return{type:r.Float,loc:{start:{line:1,column:0},end:{line:1,column:t.length}},raw:t,value:e}}(e):function(e){return"boolean"==typeof e}(e)?function(e){return{type:r.Boolean,loc:{start:{line:1,column:0},end:{line:1,column:e?4:5}},value:e}}(e):q(e)?function(e){const t=e.toISOString();return{type:r.DateTime,loc:{start:{line:1,column:0},end:{line:1,column:t.length}},raw:t,value:e}}(e):Array.isArray(e)?function(e,t){const n={type:r.InlineArray,loc:{start:{line:1,column:0},end:{line:1,column:2}},items:[]};for(const r of e){const e=qe(We(r,t));Ee(n,n,e)}return Se(n,n,t.bracketSpacing),Oe(n,n,t.trailingComma),Ce(n),n}(e,t):function(e,t){if(!N(e=Je(e)))return We(e,t);const n={type:r.InlineTable,loc:{start:{line:1,column:0},end:{line:1,column:2}},items:[]},o=[...Re(e,t)];for(const e of o){const t=qe(e);Ee(n,n,t)}return Se(n,n,t.bracketSpacing),Oe(n,n,t.trailingComma),Ce(n),n}(e,t)}function Je(e){return e&&!q(e)&&"function"==typeof e.toJSON?e.toJSON():e}const ze=/(\r\n|\n)/g;function Ge(e,t="\n"){const n=[];return be(e,{[r.TableKey](e){const{start:t,end:r}=e.loc;He(n,{start:t,end:{line:t.line,column:t.column+1}},"["),He(n,{start:{line:r.line,column:r.column-1},end:r},"]")},[r.TableArrayKey](e){const{start:t,end:r}=e.loc;He(n,{start:t,end:{line:t.line,column:t.column+2}},"[["),He(n,{start:{line:r.line,column:r.column-2},end:r},"]]")},[r.KeyValue](e){const{start:{line:t}}=e.loc;He(n,{start:{line:t,column:e.equals},end:{line:t,column:e.equals+1}},"=")},[r.Key](e){He(n,e.loc,e.raw)},[r.String](e){He(n,e.loc,e.raw)},[r.Integer](e){He(n,e.loc,e.raw)},[r.Float](e){He(n,e.loc,e.raw)},[r.Boolean](e){He(n,e.loc,e.value.toString())},[r.DateTime](e){He(n,e.loc,e.raw)},[r.InlineArray](e){const{start:t,end:r}=e.loc;He(n,{start:t,end:{line:t.line,column:t.column+1}},"["),He(n,{start:{line:r.line,column:r.column-1},end:r},"]")},[r.InlineTable](e){const{start:t,end:r}=e.loc;He(n,{start:t,end:{line:t.line,column:t.column+1}},"{"),He(n,{start:{line:r.line,column:r.column-1},end:r},"}")},[r.InlineItem](e){if(!e.comma)return;const t=e.loc.end;He(n,{start:t,end:{line:t.line,column:t.column+1}},",")},[r.Comment](e){He(n,e.loc,e.raw)}}),n.join(t)+t}function He(e,t,n){const r=n.split(ze),o=t.end.line-t.start.line+1;if(r.length!==o)throw new Error(`Mismatch between location and raw string, expected ${o} lines for "${n}"`);for(let n=t.start.line;n<=t.end.line;n++){const o=Qe(e,n),l=n===t.start.line,a=n===t.end.line,i=l?o.substr(0,t.start.column).padEnd(t.start.column,$):"",c=a?o.substr(t.end.column):"";e[n-1]=i+r[n-t.start.line]+c}}function Qe(e,t){if(!e[t-1])for(let n=0;n<t;n++)e[n]||(e[n]="");return e[t-1]}function Xe(e,t=""){const n=M(),o=new Set,l=new Set,a=new Set;let i,c=n,u=!1;return be(e,{[r.Table](e){const r=e.key.item.value;try{Ye(n,r,e.type,{tables:o,table_arrays:l,defined:a})}catch(n){throw new x(t,e.key.loc.start,n.message)}const i=tt(r);o.add(i),a.add(i),c=Ze(n,r)},[r.TableArray](e){const r=e.key.item.value;try{Ye(n,r,e.type,{tables:o,table_arrays:l,defined:a})}catch(n){throw new x(t,e.key.loc.start,n.message)}const i=tt(r);l.add(i),a.add(i),c=function(e,t){const n=et(e,t.slice(0,-1)),r=F(t);n[r]||(n[r]=[]);const o=M();return n[F(t)].push(o),o}(n,r)},[r.KeyValue]:{enter(e){if(u)return;const n=e.key.value;try{Ye(c,n,e.type,{tables:o,table_arrays:l,defined:a})}catch(n){throw new x(t,e.key.loc.start,n.message)}const s=function e(t){switch(t.type){case r.InlineTable:const n=M();return t.items.forEach(({item:t})=>{const r=t.key.value,o=e(t.value);(r.length>1?Ze(n,r.slice(0,-1)):n)[F(r)]=o}),n;case r.InlineArray:return t.items.map(t=>e(t.item));case r.String:case r.Integer:case r.Float:case r.Boolean:case r.DateTime:return t.value;default:throw new Error(`Unrecognized value type "${t.type}"`)}}(e.value);(n.length>1?Ze(c,n.slice(0,-1)):c)[F(n)]=s,a.add(tt(n)),f(e.value)&&(i=c,c=s)},exit(e){f(e.value)&&(c=i)}},[r.InlineTable]:{enter(){u=!0},exit(){u=!1}}}),n}function Ye(e,t,n,o){let l=[],a=0;for(const n of t){if(l.push(n),!L(e,n))return;if("object"!=typeof(i=e[n])&&!q(i))throw new Error(`Invalid key, a value has already been defined for ${l.join(".")}`);const r=tt(l);if(Array.isArray(e[n])&&!o.table_arrays.has(r))throw new Error(`Invalid key, cannot add to a static array at ${r}`);const c=a++<t.length-1;e=Array.isArray(e[n])&&c?F(e[n]):e[n]}var i;const c=tt(t);if(e&&n===r.Table&&o.defined.has(c))throw new Error(`Invalid key, a table has already been defined named ${c}`);if(e&&n===r.TableArray&&!o.table_arrays.has(c))throw new Error(`Invalid key, cannot add an array of tables to a table at ${c}`)}function Ze(e,t){const n=et(e,t.slice(0,-1)),r=F(t);return n[r]||(n[r]=M()),n[r]}function et(e,t){return t.reduce((e,t)=>(e[t]||(e[t]=M()),Array.isArray(e[t])?F(e[t]):e[t]),e)}function tt(e){return e.join(".")}var nt;function rt(e,t,n=[]){return e===t||(o=t,q(r=e)&&q(o)&&r.toISOString()===o.toISOString())?[]:Array.isArray(e)&&Array.isArray(t)?function(e,t,n=[]){let r=[];const o=e.map(V),l=t.map(V);l.forEach((a,i)=>{const c=i>=o.length;if(!c&&o[i]===a)return;const u=o.indexOf(a,i+1);if(!c&&u>-1){r.push({type:nt.Move,path:n,from:u,to:i});const e=o.splice(u,1);return void o.splice(i,0,...e)}const s=!l.includes(o[i]);if(!c&&s)return R(r,rt(e[i],t[i],n.concat(i))),void(o[i]=a);r.push({type:nt.Add,path:n.concat(i)}),o.splice(i,0,a)});for(let e=l.length;e<o.length;e++)r.push({type:nt.Remove,path:n.concat(e)});return r}(e,t,n):N(e)&&N(t)?function(e,t,n=[]){let r=[];const o=Object.keys(e),l=o.map(t=>V(e[t])),a=Object.keys(t),i=a.map(e=>V(t[e])),c=(e,t)=>{if(t.indexOf(e)<0)return!1;const n=o[l.indexOf(e)];return!a.includes(n)};return o.forEach((o,u)=>{const s=n.concat(o);if(a.includes(o))R(r,rt(e[o],t[o],s));else if(c(l[u],i)){const e=a[i.indexOf(l[u])];r.push({type:nt.Rename,path:n,from:o,to:e})}else r.push({type:nt.Remove,path:s})}),a.forEach((e,t)=>{o.includes(e)||c(i[t],l)||r.push({type:nt.Add,path:n.concat(e)})}),r}(e,t,n):[{type:nt.Edit,path:n}];var r,o}function ot(e,t){if(!t.length)return e;if(c(e))return ot(e.value,t);const n={};let r;if(m(e)&&e.items.some((e,o)=>{try{let l=[];if(c(e))l=e.key.value;else if(a(e))l=e.key.item.value;else if(i(e)){l=e.key.item.value;const t=V(l);n[t]||(n[t]=0);const r=n[t]++;l=l.concat(r)}else s(e)&&c(e.item)?l=e.item.key.value:s(e)&&(l=[o]);return!(!l.length||!function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}(l,t.slice(0,l.length)))&&(r=ot(e,t.slice(l.length)),!0)}catch(e){return!1}}),!r)throw new Error(`Could not find node at path ${t.join(".")}`);return r}function lt(e,t){try{return ot(e,t)}catch(e){}}function at(e,t){let n,r=t;for(;r.length&&!n;)r=r.slice(0,-1),n=lt(e,r);if(!n)throw new Error(`Count not find parent node for path ${t.join(".")}`);return n}function it(e,t,n){const o=[...ve(e)],s=Xe(o);return Ge(function(e,t,n){return n.forEach(n=>{if(function(e){return e.type===nt.Add}(n)){const r=ot(t,n.path),o=n.path.slice(0,-1);let s,f=F(n.path),d=i(r);if(P(f)&&!o.some(P)){const t=lt(e,o.concat(0));t&&i(t)&&(d=!0)}if(a(r))s=e;else if(d){s=e;const t=e,n=lt(t,o.concat(f-1)),r=lt(t,o.concat(f));f=r?t.items.indexOf(r):n?t.items.indexOf(n)+1:t.items.length}else s=at(e,n.path),c(s)&&(s=s.value);i(s)||u(s)||l(s)?Ee(e,s,r,f):Ee(e,s,r)}else if(function(e){return e.type===nt.Edit}(n)){let r,o=ot(e,n.path),l=ot(t,n.path);c(o)&&c(l)?(r=o,o=o.value,l=l.value):r=at(e,n.path),Ae(e,r,o,l)}else if(function(e){return e.type===nt.Remove}(n)){let t=at(e,n.path);c(t)&&(t=t.value);const r=ot(e,n.path);$e(e,t,r)}else if(function(e){return e.type===nt.Move}(n)){let t=ot(e,n.path);p(t)&&(t=t.item),c(t)&&(t=t.value);const r=t.items[n.from];$e(e,t,r),Ee(e,t,r,n.to)}else if(function(e){return e.type===nt.Rename}(n)){let r=ot(e,n.path.concat(n.from)),o=ot(t,n.path.concat(n.to));p(r)&&(r=r.item),p(o)&&(o=o.item),Ae(e,r,r.key,o.key)}}),Ce(e),e}({type:r.Document,loc:{start:{line:1,column:0},end:{line:1,column:0}},items:o},Ve(t,n),rt(s,t)).items)}function ct(e){return Xe(ve(e),e)}function ut(e,t){return Ge(Ve(e,t).items)}!function(e){e.Add="Add",e.Edit="Edit",e.Remove="Remove",e.Move="Move",e.Rename="Rename"}(nt||(nt={}))}]);